<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Boleta de Venta - HOTDOGZ</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f2f2f2;
    }
    .producto {
      margin-bottom: 8px;
    }
    #boleta {
      background: #fff;
      border: 1px solid #ccc;
      padding: 15px;
      margin-top: 20px;
    }
    select, input, button {
      margin-top: 5px;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>

  <h1>🐾 Tienda de Mascotas HOTDOGZ 🐾</h1>
  <h2>Menú de Productos</h2>
  <div id="productos"></div>

  <h3>Seleccione una opción:</h3>
  <select id="opcion">
    <option value="0">Seleccione...</option>
    <option value="1">Abrigo impermeable</option>
    <option value="2">Mr. Charlie Hoodie</option>
    <option value="3">Mint and Pink Stripes Hoodie</option>
    <option value="4">Comida para perros</option>
    <option value="5">Comida para gatos</option>
    <option value="6">Salir y mostrar boleta</option>
  </select>
  <button onclick="seleccionarProducto()">Aceptar</button>

  <div id="inputExtra"></div>

  <div id="boleta"></div>

  <script>
    const productos = [
      { codigo: 1, nombre: "Abrigo impermeable", precio: 89, stock: { S: 3, M: 4, L: 3, XL: 2 } },
      { codigo: 2, nombre: "Mr. Charlie Hoodie", precio: 55, stock: { S: 2, M: 3, L: 2, XL: 1 } },
      { codigo: 3, nombre: "Mint and Pink Stripes Hoodie", precio: 65, stock: { S: 2, M: 2, L: 1, XL: 1 } },
      { codigo: 4, nombre: "Comida para perros", precio: 12, stock: 50 }, // en kg
      { codigo: 5, nombre: "Comida para gatos", precio: 10, stock: 40 }
    ];

    let boleta = [];
    let total = 0;

    function mostrarProductos() {
      const divProductos = document.getElementById('productos');
      divProductos.innerHTML = "";
      productos.forEach(p => {
        const div = document.createElement('div');
        div.classList.add('producto');
        let stockTexto = "";
        if (p.codigo <= 3) {
          const st = p.stock;
          stockTexto = `Stock - S: ${st.S}, M: ${st.M}, L: ${st.L}, XL: ${st.XL}`;
        } else {
          stockTexto = `Stock: ${p.stock} kg`;
        }
        div.textContent = `${p.codigo}. ${p.nombre} (S/ ${p.precio}) - ${stockTexto}`;
        divProductos.appendChild(div);
      });
    }

    mostrarProductos();

    function seleccionarProducto() {
      const opcion = parseInt(document.getElementById("opcion").value);
      const inputDiv = document.getElementById("inputExtra");
      inputDiv.innerHTML = "";

      if (opcion >= 1 && opcion <= 3) {
        const prod = productos[opcion - 1];
        inputDiv.innerHTML = `
          <p>${prod.nombre} - S/ ${prod.precio}</p>
          <label>Cantidad S:</label> <input type="number" id="cantS" min="0" value="0"><br>
          <label>Cantidad M:</label> <input type="number" id="cantM" min="0" value="0"><br>
          <label>Cantidad L:</label> <input type="number" id="cantL" min="0" value="0"><br>
          <label>Cantidad XL:</label> <input type="number" id="cantXL" min="0" value="0"><br>
          <button onclick="agregarPrendaPorTallas(${opcion})">Agregar</button>
        `;
      } else if (opcion === 4 || opcion === 5) {
        const prod = productos[opcion - 1];
        inputDiv.innerHTML = `
          <p>${prod.nombre} - S/ ${prod.precio} por kg</p>
          <label>¿Cuántos kilogramos desea comprar?</label>
          <input type="number" id="kg" min="0.1" step="0.1"><br>
          <button onclick="agregarComida(${opcion})">Agregar</button>
        `;
      } else if (opcion === 6) {
        mostrarBoleta();
      } else {
        alert("Opción no válida.");
      }
    }

    function agregarPrendaPorTallas(opcion) {
      const cantS = parseInt(document.getElementById("cantS").value) || 0;
      const cantM = parseInt(document.getElementById("cantM").value) || 0;
      const cantL = parseInt(document.getElementById("cantL").value) || 0;
      const cantXL = parseInt(document.getElementById("cantXL").value) || 0;

      const prod = productos[opcion - 1];
      const tallas = { S: cantS, M: cantM, L: cantL, XL: cantXL };
      let algoSeVaAComprar = false;

      for (let t in tallas) {
        if (tallas[t] > 0) {
          algoSeVaAComprar = true;
          if (tallas[t] > prod.stock[t]) {
            alert(`No hay suficiente stock para talla ${t}. Solo quedan ${prod.stock[t]}.`);
            return;
          }
        }
      }

      if (!algoSeVaAComprar) {
        alert("Debe ingresar al menos una cantidad mayor a 0.");
        return;
      }

      // Agregar a boleta y restar stock
      for (let t in tallas) {
        const cantidad = tallas[t];
        if (cantidad > 0) {
          const subtotal = cantidad * prod.precio;
          total += subtotal;
          prod.stock[t] -= cantidad;
          boleta.push(`${cantidad} ${prod.nombre} - talla ${t} : S/ ${subtotal.toFixed(2)}`);
        }
      }

      alert("Producto(s) agregado(s) a la boleta.");
      document.getElementById("inputExtra").innerHTML = "";
      mostrarProductos();
    }

    function agregarComida(opcion) {
      const kg = parseFloat(document.getElementById("kg").value);
      const prod = productos[opcion - 1];

      if (kg > 0) {
        if (kg <= prod.stock) {
          const subtotal = kg * prod.precio;
          total += subtotal;
          prod.stock -= kg;
          boleta.push(`${kg} kg ${prod.nombre} : S/ ${subtotal.toFixed(2)}`);
          alert("Producto agregado a la boleta.");
          document.getElementById("inputExtra").innerHTML = "";
          mostrarProductos();
        } else {
          alert(`Stock insuficiente. Solo quedan ${prod.stock} kg disponibles.`);
        }
      } else {
        alert("Ingrese una cantidad válida.");
      }
    }

    function mostrarBoleta() {
      let resultado = "<h2>------ BOLETA DE VENTA ------</h2>";
      if (boleta.length === 0) {
        resultado += "<p>No se compró ningún producto.</p>";
      } else {
        boleta.forEach(item => {
          resultado += `<p>${item}</p>`;
        });
        resultado += "<hr>";
        resultado += `<strong>TOTAL A PAGAR: S/ ${total.toFixed(2)}</strong>`;
      }
      document.getElementById("boleta").innerHTML = resultado;
    }
  </script>

</body>
</html>